{% extends "base.html" %}

{% block title %}Login - E-Commerce{% endblock %}

{% block content %}
<div class="row justify-content-center mt-5">
  <div class="col-md-6 col-lg-5">
    <div class="card shadow">
      <div class="card-header bg-primary text-white text-center">
        <h4 class="mb-0"><i class="fas fa-sign-in-alt"></i> Fazer Login</h4>
      </div>

      <div class="card-body p-4">
        <form method="POST" class="needs-validation" novalidate>
          <!-- E-mail -->
          <div class="mb-3">
            <label for="email" class="form-label">E-mail</label>
            <div class="input-group has-validation">
              <span class="input-group-text"><i class="fas fa-envelope"></i></span>
              <input type="email"
                     class="form-control"
                     id="email"
                     name="email"
                     placeholder="voce@exemplo.com"
                     value="{{ request.form.get('email','') }}"
                     autocomplete="email"
                     required>
              <div class="invalid-feedback">Informe um e-mail válido.</div>
            </div>
          </div>

          <!-- Senha -->
          <div class="mb-3">
            <label for="senha" class="form-label">Senha</label>
            <div class="input-group has-validation">
              <span class="input-group-text"><i class="fas fa-lock"></i></span>
              <input type="password"
                     class="form-control"
                     id="senha"
                     name="senha"
                     placeholder="Digite sua senha"
                     autocomplete="current-password"
                     required>
              <button class="btn btn-outline-secondary" type="button" id="toggleSenha" aria-label="Mostrar/ocultar senha">
                <i class="far fa-eye"></i>
              </button>
              <div class="invalid-feedback">Informe sua senha.</div>
            </div>
          </div>

          <!-- Botão Entrar -->
          <div class="d-grid gap-2">
            <button type="submit" class="btn btn-primary btn-lg">
              <i class="fas fa-sign-in-alt"></i> Entrar
            </button>
          </div>
        </form>

        <hr>

        <!-- Link para cadastro -->
        <div class="text-center">
          <p class="text-muted">Ainda não tem conta?</p>
          <a href="{{ url_for('cadastro') }}" class="btn btn-outline-primary">
            <i class="fas fa-user-plus"></i> Criar Conta
          </a>
        </div>
      </div>
    </div>

    <!-- Dados de teste -->
    <div class="mt-3">
      <div class="alert alert-info small">
        <strong>Dados para teste:</strong><br>
        E-mail: <code>admin@ecommerce.com</code><br>
        Senha: <code>admin123</code>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  // Validação visual Bootstrap
  (function () {
    'use strict';
    const form = document.querySelector('.needs-validation');
    if (form) {
      form.addEventListener('submit', function (event) {
        if (!form.checkValidity()) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, false);
    }
  })();

  // Mostrar/Ocultar senha
  (function () {
    const senha = document.getElementById('senha');
    const toggle = document.getElementById('toggleSenha');

    if (toggle && senha) {
      toggle.addEventListener('click', function () {
        const isPwd = senha.getAttribute('type') === 'password';
        senha.setAttribute('type', isPwd ? 'text' : 'password');
        this.querySelector('i').classList.toggle('fa-eye');
        this.querySelector('i').classList.toggle('fa-eye-slash');
      });
    }
  })();
</script>
{% endblock %}
